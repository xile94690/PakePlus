import{z as Q,v as X,A as Z,B as ee,C as te,D as le,q as ae,F as oe,G as ne,w as se,x as re,y as ie,H as ue}from"./element-plus-CxSlioY7.js";import{b as z,c as de}from"./index-rRFGLrRk.js";import{G as pe}from"./cateManage-BpRs2yOz.js";import{u as me,a as ce}from"./alova-Dc8ujYEb.js";import{r as C,E as ge,c as E,a as V,v as t,Y as fe,W as l,j as n,e as B,M as x,F as w,ae as _e,o as p,k as R,a6 as m}from"./@vue-kKykbxn7.js";import"./dayjs-BZIFujmo.js";import"./@vueuse-Ds_1xoyw.js";import"./lodash-es-L85KEEkL.js";import"./@element-plus-CVcQ0kpg.js";import"./async-validator-9PlIezaS.js";import"./@ctrl-r5W6hzzQ.js";import"./@popperjs-D_chPuIy.js";import"./normalize-wheel-es-BQoi3Ox2.js";/* empty css                      */import"./vue-router-2E4jhvu7.js";import"./@alova-Cz8T9Pb0.js";import"./pinia-BiPvFv_h.js";import"./highlight.js-DTDMDN_T.js";import"./@highlightjs-CGChwgod.js";import"./@kjgl77-Dnb-6Rt9.js";import"./pinia-plugin-persistedstate-n2tMOXAx.js";import"./vxe-table-CidieOr-.js";import"./xe-utils-CkIl7JsB.js";import"./@vxe-ui-Cro8wKBv.js";import"./dom-zindex-DlWB42XF.js";import"./vxe-pc-ui-CyqLebZs.js";const ye=i=>z.Post("/admin/replayList",i),ve=i=>z.Post("/admin/replaySave",i),be=i=>z.Post("/admin/replayDel",i),Ce={class:"flex flex-col h-full"},Oe={__name:"index",setup(i){const c=C(!1),g=C(void 0),s=C({attachment:[]}),{proxy:T}=ge(),{data:S,loading:U}=me(()=>pe({page:1,pageSize:100})),{data:$,total:W,page:f,pageSize:_,loading:q,send:k}=ce((o,e)=>ye({page:o,pageSize:e,category:g.value}),{watchingStates:[g],debounce:300,initialData:{total:0,list:[]},data:o=>(o==null?void 0:o.list)||[],initialPage:1,initialPageSize:10}),F=C({content:[{required:!0,message:"请输入回复文本",trigger:"blur"}],keyWord:[{required:!0,message:"请输入关键字",trigger:"blur"}],attachment:[{required:!0,message:"请输入附件",trigger:"blur"}]}),I=o=>{_.value=o},M=o=>{f.value=o},h=o=>{o.category||(o.category=void 0),s.value={...o},o.attachment&&o.attachment.length?s.value.attachment=o.attachment.map(e=>({url:e,uid:new Date().getTime()})):s.value.attachment=[],c.value=!0},j=o=>{ue({title:"提示",message:"确定要删除自动回复配置吗?",showCancelButton:!0,confirmButtonText:"确认",cancelButtonText:"取消"}).then(async()=>{await be({id:o.id}),await k(),$message.success("删除成功")}).catch(()=>{})},G=()=>{T.$refs.formRef.validate(async o=>{if(o)try{await ve({...s.value,attachment:s.value.attachment.map(e=>e.url)}),c.value=!1,await k(),$message.success(s.value.id?"修改成功":"创建成功")}catch{}})},N=o=>{copyTextToClipboard(o.content)};return(o,e)=>{const D=le,L=te,u=ee,y=ae,d=Q,v=oe,A=Z,H=ne,P=ie,b=re,O=_e("a-upload"),Y=se,J=de,K=X;return p(),E(w,null,[V("div",Ce,[t(d,{gutter:10},{default:l(()=>[t(u,{span:6},{default:l(()=>[t(L,{modelValue:n(g),"onUpdate:modelValue":e[0]||(e[0]=a=>x(g)?g.value=a:null),placeholder:"请选择分类",onClear:n(k),clearable:"",loading:n(U)},{default:l(()=>{var a;return[(p(!0),E(w,null,R((a=n(S))==null?void 0:a.list,r=>(p(),B(D,{label:r.name,value:r.id,key:r.id},null,8,["label","value"]))),128))]}),_:1},8,["modelValue","onClear","loading"])]),_:1}),t(u,{span:2},{default:l(()=>[t(y,{type:"primary",onClick:h},{default:l(()=>e[8]||(e[8]=[m("新增")])),_:1})]),_:1})]),_:1}),fe((p(),B(A,{stripe:"",border:"",data:n($),class:"my-[10px] flex-1"},{default:l(()=>[t(v,{type:"index",label:"序号",width:"80"}),t(v,{prop:"keyWord",label:"关键字","min-width":"180"}),t(v,{prop:"content",label:"回复内容","min-width":"200"}),t(v,{label:"操作","min-width":"170",fixed:"right"},{default:l(({row:a})=>[t(y,{type:"success",onClick:r=>N(a)},{default:l(()=>e[9]||(e[9]=[m("复制文本")])),_:2},1032,["onClick"]),t(y,{type:"primary",onClick:r=>h(a)},{default:l(()=>e[10]||(e[10]=[m("修改")])),_:2},1032,["onClick"]),t(y,{type:"danger",onClick:r=>j(a)},{default:l(()=>e[11]||(e[11]=[m("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[K,n(q)]]),t(d,{justify:"end"},{default:l(()=>[t(H,{"current-page":n(f),"onUpdate:currentPage":e[1]||(e[1]=a=>x(f)?f.value=a:null),"page-size":n(_),"onUpdate:pageSize":e[2]||(e[2]=a=>x(_)?_.value=a:null),"page-sizes":[10,20,30,40],background:"",layout:"total, sizes, prev, pager, next, jumper",total:n(W),onSizeChange:I,onCurrentChange:M},null,8,["current-page","page-size","total"])]),_:1})]),t(J,{modelValue:n(c),"onUpdate:modelValue":e[7]||(e[7]=a=>x(c)?c.value=a:null),title:n(s).id?`修改回复配置: ${n(s).id}`:"新增回复配置","destroy-on-close":"",onSubmit:G},{default:l(()=>[t(Y,{"label-width":"100px",model:n(s),ref:"formRef",rules:n(F)},{default:l(()=>[t(d,null,{default:l(()=>[t(u,{span:12},{default:l(()=>[t(b,{label:"关键字",prop:"keyWord"},{default:l(()=>[t(P,{modelValue:n(s).keyWord,"onUpdate:modelValue":e[3]||(e[3]=a=>n(s).keyWord=a),placeholder:"请输入关键字"},null,8,["modelValue"]),e[12]||(e[12]=V("div",null,[m(" 注意: 多个关键字可用 "),V("span",{class:"text-[red]"},"英文逗号"),m(" 分割 ")],-1))]),_:1})]),_:1})]),_:1}),t(d,null,{default:l(()=>[t(u,{span:18},{default:l(()=>[t(b,{label:"回复文本",prop:"content"},{default:l(()=>[t(P,{modelValue:n(s).content,"onUpdate:modelValue":e[4]||(e[4]=a=>n(s).content=a),placeholder:"请输入回复文本",type:"textarea",rows:4},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(d,null,{default:l(()=>[t(u,{span:24},{default:l(()=>[t(b,{label:"附件"},{default:l(()=>[t(O,{modelValue:n(s).attachment,"onUpdate:modelValue":e[5]||(e[5]=a=>n(s).attachment=a),type:"list"},null,8,["modelValue"]),e[13]||(e[13]=V("div",null," 注意: 上传图片不大于10MB,多个附件将以多条消息方式发送,支持图片,视频文件,其他文档等,但不大于30MB ",-1))]),_:1})]),_:1})]),_:1}),t(d,null,{default:l(()=>[t(u,{span:10},{default:l(()=>[t(b,{label:"选择分类",prop:"category"},{default:l(()=>[t(L,{placeholder:"请选择分类",modelValue:n(s).category,"onUpdate:modelValue":e[6]||(e[6]=a=>n(s).category=a)},{default:l(()=>{var a;return[(p(!0),E(w,null,R((a=n(S))==null?void 0:a.list,r=>(p(),B(D,{label:r.name,value:r.id},null,8,["label","value"]))),256))]}),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],64)}}};export{Oe as default};
