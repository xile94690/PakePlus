import{z as W,v as J,A as K,B as O,q as Q,F as X,I as Z,G as ee,w as te,x as ae,y as le,H as y}from"./element-plus-CxSlioY7.js";import{c as oe,G as se,E as b,D as ne,A as re}from"./index-rRFGLrRk.js";import{a as ie}from"./alova-Dc8ujYEb.js";import{E as ue,r as x,c as V,a as N,v as t,Y as de,W as a,j as n,e as k,M as C,F as D,o as p,a6 as i,t as me}from"./@vue-kKykbxn7.js";import"./dayjs-BZIFujmo.js";import"./@vueuse-Ds_1xoyw.js";import"./lodash-es-L85KEEkL.js";import"./@element-plus-CVcQ0kpg.js";import"./async-validator-9PlIezaS.js";import"./@ctrl-r5W6hzzQ.js";import"./@popperjs-D_chPuIy.js";import"./normalize-wheel-es-BQoi3Ox2.js";/* empty css                      */import"./vue-router-2E4jhvu7.js";import"./@alova-Cz8T9Pb0.js";import"./pinia-BiPvFv_h.js";import"./highlight.js-DTDMDN_T.js";import"./@highlightjs-CGChwgod.js";import"./@kjgl77-Dnb-6Rt9.js";import"./pinia-plugin-persistedstate-n2tMOXAx.js";import"./vxe-table-CidieOr-.js";import"./xe-utils-CkIl7JsB.js";import"./@vxe-ui-Cro8wKBv.js";import"./dom-zindex-DlWB42XF.js";import"./vxe-pc-ui-CyqLebZs.js";const pe={class:"flex flex-col h-full"},ge={key:1},Fe={__name:"index",setup(fe){const{proxy:E}=ue(),d=x(!1),o=x({}),z=x({nickName:[{required:!0,message:"请输入用户名称",trigger:"blur"}],userName:[{required:!0,message:"请输入登录账户",trigger:"blur"}],password:[{required:!0,message:"请输入登录密码",trigger:"blur"}],passwordAg:[{required:!0,message:"请再次输入登录密码",trigger:"blur"},{validator:(s,e,r)=>{e!==o.value.password?r(new Error("两次输入密码不一致")):r()},trigger:"blur"}]}),{data:T,total:A,page:f,pageSize:c,loading:M,send:_}=ie((s,e)=>se({page:s,pageSize:e}),{immediate:!1,initialData:{total:0,data:[]},initialPage:1,initialPageSize:10}),P=s=>{c.value=s},S=s=>{f.value=s},U=()=>{o.value={},d.value=!0},I=s=>{o.value={...s},d.value=!0},j=s=>{y.prompt("请输入新的密码",`修改密码: ${s.id}`,{confirmButtonText:"提交",cancelButtonText:"取消",inputValue:"******",inputValidator:e=>e?!0:"请输入新的密码",inputErrorMessage:"Invalid Email"}).then(async({value:e})=>{const r={...s};r.password=e,await b(r),await _(),$message.success("修改密码成功")}).catch(()=>{E.$message({type:"info",message:"修改密码已取消"})})},q=s=>{y({title:"提示",message:`确定要删除 ${s.id} 账户吗?`,showCancelButton:!0,confirmButtonText:"确认",cancelButtonText:"取消"}).then(async()=>{try{await ne({id:s.id}),await _(),$message.success("删除成功")}catch{}}).catch(()=>{})},F=()=>{y({title:"提示",message:"确定要重置密码吗?",showCancelButton:!0,confirmButtonText:"确认",cancelButtonText:"取消"}).then(async()=>{try{await b({...o.value,password:"123456"}),await _(),$message.success("重置密码完成,请尽快修改密码!!")}catch{}}).catch(()=>{})},Y=()=>{E.$refs.formRef.validate(async s=>{if(!s)return;let e=o.value.id?b(o.value):re(o.value);try{await e.send(),d.value=!1,await _(),$message.success(o.value.id?"修改成功":"创建成功")}catch{}})};return(s,e)=>{const r=Q,g=O,m=W,u=X,B=Z,h=K,R=ee,w=le,v=ae,G=te,H=oe,L=J;return p(),V(D,null,[N("div",pe,[t(m,{gutter:10,justify:"end"},{default:a(()=>[t(g,{span:2},{default:a(()=>[t(r,{type:"success",onClick:U},{default:a(()=>e[7]||(e[7]=[i("创建账号")])),_:1})]),_:1})]),_:1}),de((p(),k(h,{stripe:"",border:"",data:n(T),class:"my-[10px] flex-1"},{default:a(()=>[t(u,{type:"index",label:"序号","min-width":"80"}),t(u,{prop:"id","min-width":"100",label:"ID"}),t(u,{prop:"nickName","min-width":"100",label:"管理员名称"}),t(u,{prop:"userName","min-width":"150",label:"管理员账号"}),t(u,{label:"创建时间","min-width":"200"},{default:a(({row:l})=>[i(me(s.$dayjs(l.createdAt).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1}),t(u,{label:"登录状态","min-width":"100"},{default:a(({row:l})=>[l.status==1?(p(),k(B,{key:0,type:"success"},{default:a(()=>e[8]||(e[8]=[i("启用")])),_:1})):(p(),k(B,{key:1,type:"danger"},{default:a(()=>e[9]||(e[9]=[i("禁用")])),_:1}))]),_:1}),t(u,{label:"操作",width:"260",fixed:"right"},{default:a(({row:l})=>[t(r,{type:"primary",onClick:$=>I(l)},{default:a(()=>e[10]||(e[10]=[i("编辑")])),_:2},1032,["onClick"]),t(r,{type:"primary",onClick:$=>j(l)},{default:a(()=>e[11]||(e[11]=[i("修改密码")])),_:2},1032,["onClick"]),t(r,{type:"danger",onClick:$=>q(l)},{default:a(()=>e[12]||(e[12]=[i("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[L,n(M)]]),t(m,{justify:"end"},{default:a(()=>[t(R,{"current-page":n(f),"onUpdate:currentPage":e[0]||(e[0]=l=>C(f)?f.value=l:null),"page-size":n(c),"onUpdate:pageSize":e[1]||(e[1]=l=>C(c)?c.value=l:null),"page-sizes":[10,20,30,40],background:"",layout:"total, sizes, prev, pager, next, jumper",total:n(A),onSizeChange:P,onCurrentChange:S},null,8,["current-page","page-size","total"])]),_:1})]),t(H,{modelValue:n(d),"onUpdate:modelValue":e[6]||(e[6]=l=>C(d)?d.value=l:null),title:n(o).id?`编辑账号: ${n(o).id}`:"创建账号","destroy-on-close":"",onSubmit:Y},{default:a(()=>[t(G,{"label-width":"100px",rules:n(z),model:n(o),ref:"formRef"},{default:a(()=>[t(m,null,{default:a(()=>[t(g,{span:12},{default:a(()=>[t(v,{label:"用户名称",prop:"nickName"},{default:a(()=>[t(w,{modelValue:n(o).nickName,"onUpdate:modelValue":e[2]||(e[2]=l=>n(o).nickName=l)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(m,null,{default:a(()=>[t(g,{span:12},{default:a(()=>[t(v,{label:"登录账号",prop:"userName"},{default:a(()=>[t(w,{modelValue:n(o).userName,"onUpdate:modelValue":e[3]||(e[3]=l=>n(o).userName=l)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(o).id?(p(),V("div",ge,[t(r,{type:"warning",onClick:F},{default:a(()=>e[13]||(e[13]=[i("重置登录密码")])),_:1}),e[14]||(e[14]=N("div",{class:"mt-[10px] text-[#ce3434]"}," 注意: 重置后的登录密码为: 123456, 请立即登录后台修改,避免造成损失!!! ",-1))])):(p(),V(D,{key:0},[t(m,null,{default:a(()=>[t(g,{span:12},{default:a(()=>[t(v,{label:"登录密码",prop:"password"},{default:a(()=>[t(w,{modelValue:n(o).password,"onUpdate:modelValue":e[4]||(e[4]=l=>n(o).password=l),"show-password":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(m,null,{default:a(()=>[t(g,{span:12},{default:a(()=>[t(v,{label:"确认密码",prop:"passwordAg"},{default:a(()=>[t(w,{modelValue:n(o).passwordAg,"onUpdate:modelValue":e[5]||(e[5]=l=>n(o).passwordAg=l),"show-password":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})],64))]),_:1},8,["rules","model"])]),_:1},8,["modelValue","title"])],64)}}};export{Fe as default};
